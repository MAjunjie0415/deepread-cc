<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>YouTube API æµ‹è¯•</title>
  <style>
    body { 
      font-family: monospace; 
      padding: 20px; 
      background: #1e1e1e; 
      color: #d4d4d4; 
    }
    .log { 
      background: #252526; 
      padding: 10px; 
      margin: 10px 0; 
      border-radius: 4px; 
      border-left: 3px solid #0078d4;
    }
    .success { border-left-color: #4ec9b0; }
    .error { border-left-color: #f48771; }
    button { 
      padding: 10px 20px; 
      margin: 5px; 
      cursor: pointer;
      background: #0078d4;
      color: white;
      border: none;
      border-radius: 4px;
    }
    button:hover { background: #026ec1; }
    input { 
      padding: 8px; 
      width: 400px; 
      margin: 10px 0;
      background: #3c3c3c;
      border: 1px solid #555;
      color: #d4d4d4;
      border-radius: 4px;
    }
  </style>
</head>
<body>
  <h1>YouTube å­—å¹•æå–æµ‹è¯•</h1>
  
  <input type="text" id="videoId" placeholder="è¾“å…¥è§†é¢‘ ID" value="RNJCfff1dPY">
  <br>
  
  <button onclick="testMethod1()">æµ‹è¯•æ–¹æ³•1: timedtext API</button>
  <button onclick="testMethod2()">æµ‹è¯•æ–¹æ³•2: é¡µé¢è§£æ</button>
  <button onclick="clearLogs()">æ¸…é™¤æ—¥å¿—</button>
  
  <div id="logs"></div>

  <script>
    function log(message, type = 'info') {
      const logsDiv = document.getElementById('logs');
      const logDiv = document.createElement('div');
      logDiv.className = `log ${type}`;
      logDiv.textContent = message;
      logsDiv.appendChild(logDiv);
      console.log(message);
    }

    function clearLogs() {
      document.getElementById('logs').innerHTML = '';
    }

    async function testMethod1() {
      const videoId = document.getElementById('videoId').value;
      log('ğŸ”„ [æ–¹æ³•1] æµ‹è¯• timedtext API');
      
      const languages = ['', 'en', 'zh', 'a.en', 'en-US'];
      
      for (const lang of languages) {
        try {
          const url = lang 
            ? `https://www.youtube.com/api/timedtext?v=${videoId}&lang=${lang}&fmt=json3`
            : `https://www.youtube.com/api/timedtext?v=${videoId}&fmt=json3`;
          
          log(`   å°è¯•: ${lang || 'è‡ªåŠ¨'} - ${url}`);
          
          const response = await fetch(url, {
            method: 'GET',
            mode: 'no-cors' // è·¨åŸŸè¯·æ±‚
          });
          
          log(`   å“åº”: ${response.type} (no-cors æ¨¡å¼æ— æ³•è¯»å–å†…å®¹)`, 'info');
          
        } catch (e) {
          log(`   âŒ é”™è¯¯: ${e.message}`, 'error');
        }
      }
    }

    async function testMethod2() {
      const videoId = document.getElementById('videoId').value;
      log('ğŸ”„ [æ–¹æ³•2] æµ‹è¯•é¡µé¢è§£æ');
      
      try {
        const url = `https://www.youtube.com/watch?v=${videoId}`;
        log(`   è·å–é¡µé¢: ${url}`);
        
        const response = await fetch(url, {
          method: 'GET',
          mode: 'no-cors'
        });
        
        log(`   å“åº”: ${response.type}`, 'info');
        log('   âš ï¸  æµè§ˆå™¨ CORS é™åˆ¶ï¼Œæ— æ³•è¯»å–é¡µé¢å†…å®¹', 'error');
        log('   ğŸ’¡ è¿™å°±æ˜¯ä¸ºä»€ä¹ˆéœ€è¦æœåŠ¡å™¨ç«¯ä»£ç†ï¼', 'info');
        
      } catch (e) {
        log(`   âŒ é”™è¯¯: ${e.message}`, 'error');
      }
    }

    // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨æµ‹è¯•
    window.onload = () => {
      log('ğŸ“‹ YouTube å­—å¹•æå–æµ‹è¯•å·¥å…·');
      log('ğŸ’¡ æç¤ºï¼šæµè§ˆå™¨ç›´æ¥è¯·æ±‚ä¼šè¢« CORS é˜»æ­¢ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆéœ€è¦æœåŠ¡å™¨ç«¯ä»£ç†');
      log('');
    };
  </script>
</body>
</html>

